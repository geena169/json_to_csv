Конвертация файла json в csv файл.

Задача:
Ковертировать json файл в csv выбрав необходимые поля со значениями для добавления в конечный файл. Количество полей заранее неизвестнои и может отличаться в зависимости от строки. Необходимо найти все поля, а затем сконфигурировать csv файл с выбранными полями.
Так как это был мой первый опыт с Python я решил не использовать Pandas, а написать парсер самостоятельно.

Сквозь время я понимаю, что написано это не самым лучшим образом, и что подход не самый оптимальный, т.к. обработка больших фвйлов занимает достаточно много времни,
но это была моя первая попытка, которая помогла мне с обработкой не одного файла
